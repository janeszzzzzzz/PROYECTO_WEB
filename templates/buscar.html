<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Buscar MAC o IP</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

<div class="container mt-5">

    <h1 class="mb-4 text-center">Buscar MAC / IP</h1>

    <!-- Card -->
    <div class="card shadow mb-4">
        <div class="card-body">

            <h4>Datos de búsqueda</h4>

            <div class="row mb-3">
                <div class="col">
                    <label>IP del switch</label>
                    <input id="ip_switch" class="form-control" placeholder="192.168.1.1">
                </div>

                <div class="col">
                    <label>Usuario</label>
                    <input id="usuario" class="form-control">
                </div>

                <div class="col">
                    <label>Contraseña</label>
                    <input id="contrasena" type="password" class="form-control">
                </div>
            </div>

            <div class="row mb-3">
                <div class="col">
                    <label>Buscar por:</label>
                    <select id="modo" class="form-control">
                        <option value="ip">IP</option>
                        <option value="mac">MAC</option>
                    </select>
                </div>

                <div class="col">
                    <label>Valor a buscar</label>
                    <input id="objetivo" class="form-control" placeholder="Ej: 192.168.1.29 o aabb.ccdd.eeff">
                </div>
            </div>

            <button class="btn btn-primary" onclick="buscar()">Buscar</button>
        </div>
    </div>

    <!-- Resultados -->
    <div class="card shadow">
        <div class="card-body">
            <h4>Resultado</h4>
            <div id="resultado" class="mt-3 text-monospace">
                <p class="text-muted">Aún no hay resultados</p>
            </div>
        </div>
    </div>

</div>

<script>
async function buscar() {

    document.getElementById("resultado").innerHTML = "⏳ Buscando...puto";

    const data = {
        ip_switch: document.getElementById("ip_switch").value,
        usuario: document.getElementById("usuario").value,
        contrasena: document.getElementById("contrasena").value,
        objetivo: document.getElementById("objetivo").value,
        modo: document.getElementById("modo").value
    };

    try {
        const response = await fetch("/api/buscar", {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify(data)
        });

        const json = await response.json();

        if (!response.ok) {
            document.getElementById("resultado").innerHTML =
                "❌ Error: " + (json.error || "Error desconocido");
            return;
        }

        document.getElementById("resultado").innerHTML =
            "<pre>" + JSON.stringify(json, null, 2) + "</pre>";

    } catch (err) {
        document.getElementById("resultado").innerHTML =
            "❌ Error de conexión al servidor  puto puto puto puto puto puto puto puto puto puto puto puto puto puto puto puto p";
    }
}
</script>

</body>
</html>
